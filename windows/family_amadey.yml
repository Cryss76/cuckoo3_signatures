name: family_amadey
signatures:
  amadey:
    short_description: Detected Amadey Trojan
    description: Amadey bot is a simple trojan bot primarily used for collecting reconnaissance.
    tags: trojan
    family: amadey
    triggers:
    - file write:
      - ^C:\\ProgramData\\[a-z0-9]{10,15}\\bdif\.exe$
    - indicator:
      - amadey_plugins
      indicator:
      - amadey_persistence
   
indicators:
  amadey_plugins:
    - file write:
      - ^C:\\ProgramData\\[a-z0-9]{10,15}\\cred\.dll$
      file write:
      - ^C:\\ProgramData\\[a-z0-9]{10,15}\\scr\.dll$
    - file write:
      - ^C:\\Users\\user\\AppData\\Local\\Temp\\cred\.dll$
      file write:
      - ^C:\\Users\\user\\AppData\\Local\\Temp\\scr\.dll$

  amadey_persistence:
    - registry write:
      - ^HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\cred$
      registry write:
      - ^HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\scr$     
