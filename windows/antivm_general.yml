name: antim_general
signatures:
  registry_antivm_cpu_check:
    short_description: Checks the CPU name in the registry
    description: Looks up registry value(s) which can often be used to detect a virtual environment.
    score: 7
    ttps:
    - T1012
    - T1082
    - T1497.001
    triggers:
    - registry read:
      - ^(HKLM|HKCU)\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\[^\\]+\\ProcessorNameString$

  files_antivm_cuckoo:
    short_description: Attempts to detect Cuckoo Sandbox through the presence of a file
    score: 9
    ttps:
    - T1497.001
    triggers:
    - file read:
      - \\agent\.(py|pyw)$
    - file read:
      - \\analyzer\.py$
    - file read:
      - \\cuckoo\\dll
    - file read:
      - \\pipe\\cuckoo
