name: browser_interaction
signatures:
  registry_creates_ie_bho:
    short_description: Installs/modifies a Browser Helper Object (BHO)
    description: BHOs are DLL modules which act as plugins for Internet Explorer.
    score: 6
    ttps:
    - T1176
    - T1112
    triggers:
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects(\\|$)

  registry_modifies_browser_security:
    short_description: Attempts to modify browser security settings
    description: Modifies registry key(s) to change Internet Explorer security settings.
    score: 6
    ttps:
    - T1112
    triggers:
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Internet Explorer\\Privacy\\EnableInPrivateMode$
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Internet Explorer\\PhishingFilter\\
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\[0-4]\\
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains\\
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\EscDomains\\
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\EscRanges\\
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\IEHarden$
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\CertificateRevocation$
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Internet Explorer\\Main\\NoUpdateCheck$
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Internet Explorer\\Security\\
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\

  registry_modifies_browser_warnings:
    short_description: Attempts to disable browser security warnings
    description: Modifies registry keys to prevent warnings being shown to the user for various suspicious actions.
    score: 7
    ttps:
    - T1112
    - T1562.006
    triggers:
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\WarnOnBadCertRecving$
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\WarnOnBadCertSending$
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\WarnOnHTTPSToHTTPRedirect$
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\WarnOnZoneCrossing$
    - registry write:
      - ^*HKLM|HKCU)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\WarnOnPostRedirect$
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\IEHardenIENoWarn$
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Internet Explorer\\Main\\NoProtectedModeBanner$
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Internet Explorer\\Main\\IE9RunOncePerInstall$

  registry_sets_ie_homepage:
    short_description: Attempts to modify browser home page
    description: Makes registry changes to change the default home/start page for one or more web browsers.
    score: 6
    ttps:
    - T1112
    triggers:
    - registry write:
      - ^(HKLM|HKCU)\\SOFTWARE\\Microsoft\\Internet Explorer\\Main\\Start Page$
    - registry write:
      - ^HKEY_CLASSES_ROOT\\Local Settings\\Software\\Microsoft\\Windows\\CurrentVersion\\AppContainer\\Storage\\microsoft\.microsoftedge_8wekyb3d8bbwe\\MicrosoftEdge\\Main\\HomeButtonEnabled$ 
      - ^HKEY_CLASSES_ROOT\\Local Settings\\Software\\Microsoft\\Windows\\CurrentVersion\\AppContainer\\Storage\\microsoft\.microsoftedge_8wekyb3d8bbwe\\MicrosoftEdge\\Main\\HomeButtonPage$
